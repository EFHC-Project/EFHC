"""
==============================================================================
== EFHC Bot — logging_core
------------------------------------------------------------------------------
Назначение: единообразная конфигурация структурированных логов для всех
сервисов EFHC (API, бота, планировщика), чтобы трассировка денег/энергии была
считываемой и стабильной в проде.

Канон/инварианты:
  • Балансы не изменяет — только настраивает логгеры.
  • Логи уровня INFO/ERROR обязательны для денежного пути и планировщика,
    чтобы ретраи и идемпотентность были видны.
  • Формат логов стабильный: timestamp + level + logger name + message.

ИИ-защиты/самовосстановление:
  • Нулевое состояние по умолчанию: даже если конфиг не загружен, базовая
    настройка не ломает приложение.
  • Логгер создаётся лениво (get_logger), что исключает падения при импорте.

Запреты:
  • Не добавляет хендлеры для сторонних сетей; не пишет в файлы.
  • Не выполняет побочных эффектов при импорте кроме базовой конфигурации.
==============================================================================
"""

from __future__ import annotations

import logging

logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s [%(levelname)s] %(name)s: %(message)s",
)


def get_logger(name: str) -> logging.Logger:
    """Вернуть модульный логгер с каноническим форматом.

    Назначение: обеспечить единый формат логов для всех модулей EFHC.
    Вход: name — имя модуля (обычно __name__).
    Выход: готовый logging.Logger с базовой конфигурацией.
    Побочные эффекты: только чтение глобальной конфигурации logging; балансы
    и БД не затрагивает.
    Идемпотентность: повторные вызовы возвращают один и тот же логгер без
    добавления новых хендлеров (стандартное поведение logging).
    Исключения: отсутствуют при штатной работе; при некорректном имени Python
    вернёт логгер с данным именем без поднятия ошибок.
    """

    return logging.getLogger(name)


# ============================================================================
# Пояснения «для чайника»:
#   • Этот модуль только настраивает логирование и не меняет балансы.
#   • Формат логов фиксирован и помогает быстро искать трассировки банковских
#     операций и ретраев планировщика.
#   • Можно безопасно импортировать в любом месте — побочных эффектов кроме
#     базовой конфигурации нет.
# ============================================================================
