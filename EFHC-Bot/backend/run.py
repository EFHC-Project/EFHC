# ==============================================================================
# EFHC Bot — backend entrypoint
# ------------------------------------------------------------------------------
# Назначение: стартовая точка FastAPI-сервера EFHC Bot с каноническим стеком.
#
# Канон/инварианты:
#   • Перед запуском проверяем пер-секундные ставки генерации в create_app().
#   • Денежные маршруты требуют Idempotency-Key и проходят через middleware.
#   • Балансы меняет только банковский сервис; здесь нет бизнес-логики.
#   • Scheduler/бот поднимаются отдельно; этот файл лишь поднимает API.
#
# ИИ-защиты/самовосстановление:
#   • create_app() подключает MonetaryIdempotencyMiddleware и ETag на GET.
#   • В случае ошибки старта uvicorn логирует и завершает процесс без «тихих»
#     падений; повторный запуск допустим и идемпотентен.
#
# Запреты:
#   • Не содержит P2P, не двигает EFHC/kWh, не запускает планировщик.
#   • Не создаёт событий бота; только HTTP API.
# ==============================================================================
from __future__ import annotations

import uvicorn

from app import create_app


def main() -> None:
    """Запустить FastAPI-приложение EFHC Bot."""

    uvicorn.run(create_app(), host="0.0.0.0", port=8000)


if __name__ == "__main__":
    main()

# ==============================================================================
# Пояснения «для чайника»:
#   • Этот файл только стартует сервер: бизнес-логики внутри нет.
#   • Балансы не трогаем; все деньги идут через services/transactions_service.py.
#   • Ошибки старта видны в логах uvicorn; повторный запуск безопасен.
#   • Планировщики (generate_energy, check_ton_inbox и др.) запускаются отдельно.
# ==============================================================================
