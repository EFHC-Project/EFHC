/**
======================================================================
== EFHC Bot WebApp — клиентская аутентификация                        ==
======================================================================
Назначение: извлекает токен/инициализационные данные Telegram WebApp для подписывания запросов.
Инварианты: не создаёт деньги и не меняет балансы; только возвращает безопасные идентификаторы.
ИИ-защита: мягкая деградация — при отсутствии window/Telegram возвращает null без исключений.
Запреты: не хранит секреты в коде, не генерирует Idempotency-Key и не выполняет денежные POST.
======================================================================
*/
export function getAuthToken(): string | null {
  if (typeof window === "undefined") {
    return null;
  }

  const tg = (window as typeof window & { Telegram?: any }).Telegram;
  const initData = tg?.WebApp?.initDataUnsafe?.query_id ?? null;
  return typeof initData === "string" && initData.length > 0 ? initData : null;
}

// ======================================================================
// Пояснения «для чайника»:
//   • Возвращает query_id из Telegram WebApp, если доступен.
//   • При SSR или без Telegram даёт null и не ломает страницу.
//   • Токен не используется для денег — только как идентификатор сессии.
// ======================================================================
