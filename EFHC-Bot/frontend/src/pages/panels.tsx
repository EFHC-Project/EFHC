/**
======================================================================
== EFHC Bot WebApp — раздел панелей                                   ==
======================================================================
Назначение: показывает все активные панели и их срок жизни; покупки выполняются через сервер с Idempotency-Key.
Инварианты: цена панели 100 EFHC, срок жизни 180 дней, генерация per-second; клиент не считает и не списывает средства.
ИИ-защита: безопасная загрузка списка с fallback на пустой массив.
Запреты: нет локальных покупок, нет EFHC→kWh, нет P2P.
======================================================================
*/
import { useEffect, useState } from "react";

import PanelsList from "../components/PanelsList";
import { ApiClient, PanelView } from "../lib/api";

const api = new ApiClient();

function PanelsPage() {
  const [panels, setPanels] = useState<PanelView[]>([]);

  useEffect(() => {
    api.getPanels().then(setPanels);
  }, []);

  return (
    <main>
      <PanelsList
        panels={panels.map((panel) => ({
          id: panel.id,
          expiresAt: panel.expiresAt,
          dailyKwh: panel.dailyKwh,
        }))}
      />
    </main>
  );
}

export default PanelsPage;

// ======================================================================
// Пояснения «для чайника»:
//   • Здесь только чтение списка панелей; покупка идёт через серверные ручки.
//   • Панели не продлеваются на клиенте — срок жизни фиксирован 180 дней.
//   • При пустом списке покажется сообщение без ошибок.
// ======================================================================
